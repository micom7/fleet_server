<tr id="user-{{ u.id }}">
  <td>
    <strong>{{ u.email }}</strong>
    {% if u.full_name %}<br><small class="text-muted">{{ u.full_name }}</small>{% endif %}
  </td>
  <td>
    {% if u.role == 'superuser' %}
    <span class="badge badge-danger">superuser</span>
    {% else %}
    <span class="badge badge-secondary">owner</span>
    {% endif %}
  </td>
  <td>
    {% if u.status == 'active' %}<span class="badge badge-success">active</span>
    {% elif u.status == 'pending' %}<span class="badge badge-warning">pending</span>
    {% elif u.status == 'blocked' %}<span class="badge badge-danger">blocked</span>
    {% endif %}
  </td>
  <td><small class="text-muted">{{ u.created_at.strftime('%d.%m.%Y') }}</small></td>
  <td>
    {% set is_self = (cu.id | string) == (u.id | string) %}
    {% if u.status == 'pending' %}
    <button class="btn btn-success btn-xs mr-1"
            hx-post="/web/admin/users/{{ u.id }}/approve"
            hx-target="#user-{{ u.id }}" hx-swap="outerHTML">
      <i class="fas fa-check mr-1"></i>Підтвердити
    </button>
    <button class="btn btn-secondary btn-xs"
            hx-post="/web/admin/users/{{ u.id }}/block"
            hx-target="#user-{{ u.id }}" hx-swap="outerHTML">
      Відхилити
    </button>
    {% elif u.status == 'active' and not is_self %}
    <button class="btn btn-outline-danger btn-xs"
            hx-post="/web/admin/users/{{ u.id }}/block"
            hx-target="#user-{{ u.id }}" hx-swap="outerHTML"
            hx-confirm="Заблокувати {{ u.email }}?">
      <i class="fas fa-ban mr-1"></i>Блокувати
    </button>
    {% elif u.status == 'blocked' and not is_self %}
    <button class="btn btn-outline-success btn-xs"
            hx-post="/web/admin/users/{{ u.id }}/unblock"
            hx-target="#user-{{ u.id }}" hx-swap="outerHTML">
      <i class="fas fa-unlock mr-1"></i>Розблокувати
    </button>
    {% endif %}
  </td>
</tr>
